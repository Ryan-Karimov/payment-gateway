# Политика безопасности

## Поддерживаемые версии

| Версия | Поддержка          |
| ------ | ------------------ |
| 1.x.x  | :white_check_mark: |
| < 1.0  | :x:                |

## Сообщение об уязвимости

Мы серьёзно относимся к безопасности. Если вы обнаружили уязвимость, следуйте этим шагам:

### НЕ делайте

- Не открывайте публичный GitHub issue
- Не раскрывайте уязвимость публично до её исправления
- Не эксплуатируйте уязвимость

### Делайте

1. **Напишите нам** на security@yourdomain.com с указанием:
   - Описание уязвимости
   - Шаги воспроизведения
   - Потенциальное воздействие
   - Предложения по исправлению (опционально)

2. **Дайте время** на ответ (обычно в течение 48 часов)

3. **Работайте с нами** над исправлением до публичного раскрытия

## Меры безопасности

В проекте реализованы следующие меры безопасности:

### Аутентификация и авторизация

- **Аутентификация по API ключам**: Все API запросы требуют валидные API ключи
- **Хэширование ключей**: API ключи хранятся как SHA-256 хэши, никогда в открытом виде
- **Timing-Safe сравнение**: Защита от timing-атак при аутентификации

### Защита данных

- **Валидация входных данных**: Все входные данные валидируются через JSON Schema
- **Защита от SQL-инъекций**: Параметризованные запросы используются везде
- **Обработка чувствительных данных**: Пароли и ключи никогда не логируются

### Сетевая безопасность

- **Только HTTPS**: Продакшн деплои должны использовать HTTPS
- **SSRF защита**: URL вебхуков валидируются для предотвращения SSRF атак
- **Rate Limiting**: Лимиты по мерчантам предотвращают злоупотребления

### Безопасность вебхуков

- **HMAC подписи**: Все вебхуки подписаны HMAC-SHA256
- **Валидация timestamp**: Защита от replay-атак
- **Валидация URL**: Блокировка запросов к приватным/внутренним сетям

### Инфраструктура

- **Non-root контейнер**: Docker контейнеры работают от непривилегированного пользователя
- **Управление секретами**: Переменные окружения для чувствительной конфигурации
- **Сканирование зависимостей**: Регулярный аудит безопасности зависимостей

## Лучшие практики для деплоя

### Переменные окружения

```bash
# Генерация надёжных секретов
WEBHOOK_SECRET=$(openssl rand -hex 32)
DB_PASSWORD=$(openssl rand -base64 24)
```

### База данных

- Используйте SSL соединения в продакшне
- Настройте правильные права доступа
- Регулярные бэкапы с шифрованием

### Сеть

- Используйте reverse proxy (nginx, Traefik)
- Включите TLS 1.3
- Настройте правильные CORS политики

### Мониторинг

- Включите аудит-логирование
- Отслеживайте подозрительные паттерны
- Настройте алерты на неудачные попытки аутентификации

## Чеклист безопасности для контрибьюторов

При внесении кода убедитесь:

- [ ] Нет захардкоженных секретов или учётных данных
- [ ] Валидация входных данных для всех пользовательских вводов
- [ ] Параметризованные запросы к базе данных
- [ ] Правильная обработка ошибок (без чувствительной информации в ошибках)
- [ ] Безопасная генерация случайных чисел где необходимо
- [ ] Зависимости обновлены

## Известные особенности безопасности

### Эмуляция провайдеров

Этот проект включает **эмулированные** платёжные провайдеры для разработки/тестирования. В продакшне:

- Замените эмулированные провайдеры на реальные SDK
- Реализуйте правильную аутентификацию провайдеров
- Следуйте рекомендациям безопасности провайдеров

### API ключи

- API ключи в этой реализации упрощены
- Рассмотрите реализацию ротации ключей
- Добавьте whitelist IP адресов для продакшна

## Обновления безопасности

Обновления безопасности выпускаются как patch версии. Мы рекомендуем:

1. Подписаться на уведомления о релизах
2. Обновляться оперативно при выходе security патчей
3. Проверять CHANGELOG на security-изменения

## Контакты

По вопросам безопасности: security@yourdomain.com

Общие вопросы: Откройте GitHub issue

